{"ast":null,"code":"import { OperationResolver, PaginatedOperationResolver, ApiUtilsConfig } from '@moralisweb3/api-utils';\nimport { StreamErrorCode, MoralisStreamError, CoreProvider, ApiModule } from '@moralisweb3/common-core';\nimport { createStreamAptosOperation, createStreamEvmOperation, updateStreamAptosOperation, updateStreamEvmOperation, deleteStreamAptosOperation, deleteStreamEvmOperation, getStreamsAptosOperation, getStreamsEvmOperation, addAddressAptosOperation, addAddressEvmOperation, updateStreamStatusAptosOperation, updateStreamStatusEvmOperation, getAddressesAptosOperation, getAddressesEvmOperation, deleteAddressAptosOperation, deleteAddressEvmOperation, getStreamAptosOperation, getStreamEvmOperation, getHistoryOperation, getLogsOperation, replayHistoryOperation, getStatsOperation, getStatsByIdOperation, setSettingsOperation, getSettingsOperation } from '@moralisweb3/common-streams-utils';\nimport { toBuffer, bufferToHex, keccak256 } from 'ethereumjs-util';\nimport { sha256 } from '@ethersproject/sha2';\nimport { toUtf8Bytes } from '@ethersproject/strings';\nimport { BigNumber } from '@ethersproject/bignumber';\nimport { Indexed, Interface } from '@ethersproject/abi';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nfunction __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\nvar StreamNetwork;\n(function (StreamNetwork) {\n  StreamNetwork[\"APTOS\"] = \"aptos\";\n  StreamNetwork[\"EVM\"] = \"evm\";\n})(StreamNetwork || (StreamNetwork = {}));\nvar IncorrectNetworkError = /** @class */function (_super) {\n  __extends(IncorrectNetworkError, _super);\n  function IncorrectNetworkError(network) {\n    return _super.call(this, {\n      code: StreamErrorCode.INCORRECT_NETWORK,\n      message: \"Incorrect network provided. Got \\\"\".concat(network, \"\\\", Valid values are: \").concat(Object.values(StreamNetwork).map(function (value) {\n        return \"\\\"\".concat(value, \"\\\"\");\n      }).join(', '))\n    }) || this;\n  }\n  return IncorrectNetworkError;\n}(MoralisStreamError);\nvar makeCreateAptosStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(createStreamAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeCreateEvmStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(createStreamEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeCreateStream = function (core, baseUrl) {\n  return function (createStreamOptions) {\n    switch (createStreamOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeCreateAptosStream(core, baseUrl, createStreamOptions);\n      case StreamNetwork.EVM:\n        return makeCreateEvmStream(core, baseUrl, createStreamOptions);\n      default:\n        if (createStreamOptions.networkType === undefined) {\n          return makeCreateEvmStream(core, baseUrl, createStreamOptions);\n        }\n        throw new IncorrectNetworkError(createStreamOptions.networkType);\n    }\n  };\n};\nvar makeUpdateAptosStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(updateStreamAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeUpdateEvmStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(updateStreamEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeUpdateStream = function (core, baseUrl) {\n  return function (updateStreamOptions) {\n    switch (updateStreamOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeUpdateAptosStream(core, baseUrl, updateStreamOptions);\n      case StreamNetwork.EVM:\n        return makeUpdateEvmStream(core, baseUrl, updateStreamOptions);\n      default:\n        if (updateStreamOptions.networkType === undefined) {\n          return makeUpdateEvmStream(core, baseUrl, updateStreamOptions);\n        }\n        throw new IncorrectNetworkError(updateStreamOptions.networkType);\n    }\n  };\n};\nvar makeDeleteAptosStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(deleteStreamAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeDeleteEvmStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(deleteStreamEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeDeleteStream = function (core, baseUrl) {\n  return function (deleteStreamOptions) {\n    switch (deleteStreamOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeDeleteAptosStream(core, baseUrl, deleteStreamOptions);\n      case StreamNetwork.EVM:\n        return makeDeleteEvmStream(core, baseUrl, deleteStreamOptions);\n      default:\n        if (deleteStreamOptions.networkType === undefined) {\n          return makeDeleteEvmStream(core, baseUrl, deleteStreamOptions);\n        }\n        throw new IncorrectNetworkError(deleteStreamOptions.networkType);\n    }\n  };\n};\nvar makeGetAptosStream$1 = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new PaginatedOperationResolver(getStreamsAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeGetEvmStream$1 = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new PaginatedOperationResolver(getStreamsEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeGetStreams = function (core, baseUrl) {\n  return function (getStreamsOptions) {\n    switch (getStreamsOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeGetAptosStream$1(core, baseUrl, getStreamsOptions);\n      case StreamNetwork.EVM:\n        return makeGetEvmStream$1(core, baseUrl, getStreamsOptions);\n      default:\n        if (getStreamsOptions.networkType === undefined) {\n          return makeGetEvmStream$1(core, baseUrl, getStreamsOptions);\n        }\n        throw new IncorrectNetworkError(getStreamsOptions.networkType);\n    }\n  };\n};\nvar SHA3_NULL_S = '0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470';\nvar isHexStrict = function (hex) {\n  return /^(-)?0x[0-9a-f]*$/i.test(hex);\n};\nvar sha3 = function (value) {\n  var bufferValue;\n  if (isHexStrict(value) && /^0x/i.test(value.toString())) {\n    bufferValue = toBuffer(value);\n  } else {\n    // Assume value is an arbitrary string\n    bufferValue = Buffer.from(value, 'utf-8');\n  }\n  var returnValue = bufferToHex(keccak256(bufferValue));\n  if (returnValue === SHA3_NULL_S) {\n    return null;\n  }\n  return returnValue;\n};\nvar StreamsConfig = {\n  streamsSecret: {\n    name: 'streamsSecret',\n    defaultValue: null\n  }\n};\nvar makeVerifySignature = function (config) {\n  return function (_a) {\n    var body = _a.body,\n      signature = _a.signature;\n    var secret = config.get(StreamsConfig.streamsSecret);\n    if (!secret) {\n      secret = config.get(ApiUtilsConfig.apiKey);\n    }\n    if (!secret) {\n      throw new MoralisStreamError({\n        code: StreamErrorCode.GENERIC_STREAM_ERROR,\n        message: 'Unable to verify signature without an api key or streams secret'\n      });\n    }\n    var generatedSignature = sha3(JSON.stringify(body) + secret);\n    if (signature !== generatedSignature) {\n      throw new MoralisStreamError({\n        code: StreamErrorCode.INVALID_SIGNATURE,\n        message: 'Signature is not valid'\n      });\n    }\n    return true;\n  };\n};\nvar makeAddAddressAptosStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(addAddressAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeAddAddressEvmStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(addAddressEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeAddAddress = function (core, baseUrl) {\n  return function (addAddressOptions) {\n    switch (addAddressOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeAddAddressAptosStream(core, baseUrl, addAddressOptions);\n      case StreamNetwork.EVM:\n        return makeAddAddressEvmStream(core, baseUrl, addAddressOptions);\n      default:\n        if (addAddressOptions.networkType === undefined) {\n          return makeAddAddressEvmStream(core, baseUrl, addAddressOptions);\n        }\n        throw new IncorrectNetworkError(addAddressOptions.networkType);\n    }\n  };\n};\nvar makeUpdateAptosStreamStatus = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(updateStreamStatusAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeUpdateEvmStreamStatus = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(updateStreamStatusEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeUpdateStreamStatus = function (core, baseUrl) {\n  return function (updateStreamOptions) {\n    switch (updateStreamOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeUpdateAptosStreamStatus(core, baseUrl, updateStreamOptions);\n      case StreamNetwork.EVM:\n        return makeUpdateEvmStreamStatus(core, baseUrl, updateStreamOptions);\n      default:\n        if (updateStreamOptions.networkType === undefined) {\n          return makeUpdateEvmStreamStatus(core, baseUrl, updateStreamOptions);\n        }\n        throw new IncorrectNetworkError(updateStreamOptions.networkType);\n    }\n  };\n};\nvar hasAbis = function (webhookData) {\n  if (!webhookData.abi || webhookData.abi.length < 1) {\n    return false;\n  }\n  return true;\n};\nvar isWebhook = function (webhookData) {\n  if (typeof webhookData !== 'object' || webhookData === null || !('logs' in webhookData)) {\n    return false;\n  }\n  return true;\n};\nvar CollectionNameBuilder = /** @class */function () {\n  function CollectionNameBuilder() {\n    this.cache = {};\n    this.cacheLimit = 256;\n  }\n  CollectionNameBuilder.prototype.build = function (tag) {\n    var result = this.cache[tag];\n    if (!result) {\n      result = this.process(tag);\n      if (this.cacheLimit > 0) {\n        // Simple anti DDOS protection.\n        this.cache[tag] = result;\n        this.cacheLimit--;\n      }\n    }\n    return result;\n  };\n  CollectionNameBuilder.prototype.process = function (tag) {\n    var parts = tag.split(/[^a-zA-Z0-9_]/).filter(function (p) {\n      return !!p;\n    }).map(function (p) {\n      return p.substring(0, 1).toUpperCase() + p.substring(1).toLowerCase();\n    });\n    if (parts.length < 1) {\n      throw new Error(\"Cannot build table name from value \\\"\".concat(tag, \"\\\"\"));\n    }\n    return parts.join('');\n  };\n  return CollectionNameBuilder;\n}();\nvar SimpleProcessor = /** @class */function () {\n  function SimpleProcessor(collectionNameBuilder, documentBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n    this.documentBuilder = documentBuilder;\n  }\n  SimpleProcessor.prototype.process = function (items, batch) {\n    var updates = [];\n    if (items) {\n      for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\n        var item = items_1[_i];\n        var document_1 = this.documentBuilder(item, batch.block, batch.confirmed, batch.chainId);\n        updates.push({\n          collectionName: this.collectionNameBuilder.build(batch.tag),\n          document: document_1\n        });\n      }\n    }\n    return updates;\n  };\n  return SimpleProcessor;\n}();\nvar Sha256 = /** @class */function () {\n  function Sha256() {}\n  Sha256.hash = function (value) {\n    var bytes = toUtf8Bytes(value);\n    return sha256(bytes);\n  };\n  return Sha256;\n}();\nvar LogRelatedId = /** @class */function () {\n  function LogRelatedId() {}\n  LogRelatedId.create = function (chainId, transactionHash, logIndex) {\n    var safeTransactionHash = transactionHash.toLowerCase();\n    return Sha256.hash(\"\".concat(chainId, \";\").concat(safeTransactionHash, \";\").concat(logIndex));\n  };\n  return LogRelatedId;\n}();\nvar TriggerItemsBuilder = /** @class */function () {\n  function TriggerItemsBuilder() {}\n  TriggerItemsBuilder.build = function (triggers) {\n    if (!triggers || triggers.length === 0) {\n      return undefined;\n    }\n    return triggers.map(function (trigger) {\n      return {\n        name: String(trigger.name),\n        value: convertValue(trigger.value)\n      };\n    });\n  };\n  return TriggerItemsBuilder;\n}();\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction convertValue(value) {\n  var type = typeof value;\n  if (type === 'string' || type === 'number' || type === 'boolean') {\n    return value;\n  }\n  if (Array.isArray(value)) {\n    return value.map(convertValue);\n  }\n  return String(value);\n}\nvar Erc20TransferDocumentBuilder = /** @class */function () {\n  function Erc20TransferDocumentBuilder() {}\n  Erc20TransferDocumentBuilder.build = function (transfer, block, confirmed, chainId) {\n    var chain = Number(chainId);\n    var document = {\n      id: LogRelatedId.create(chain, transfer.transactionHash, transfer.logIndex),\n      transactionHash: transfer.transactionHash,\n      contract: transfer.contract,\n      logIndex: transfer.logIndex,\n      from: transfer.from,\n      to: transfer.to,\n      value: transfer.value,\n      tokenDecimals: parseInt(transfer.tokenDecimals, 10),\n      tokenName: transfer.tokenName,\n      tokenSymbol: transfer.tokenSymbol,\n      blockHash: block.hash,\n      blockTimestamp: parseInt(block.timestamp, 10),\n      blockNumber: parseInt(block.number, 10),\n      confirmed: confirmed,\n      chainId: chain,\n      triggers: TriggerItemsBuilder.build(transfer.triggers)\n    };\n    return document;\n  };\n  return Erc20TransferDocumentBuilder;\n}();\nvar Erc20TransfersProcessor = /** @class */function () {\n  function Erc20TransfersProcessor(collectionNameBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n    this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, Erc20TransferDocumentBuilder.build);\n  }\n  Erc20TransfersProcessor.prototype.process = function (batch) {\n    return this.simpleProcessor.process(batch.erc20Transfers, batch);\n  };\n  return Erc20TransfersProcessor;\n}();\nvar Erc20ApprovalDocumentBuilder = /** @class */function () {\n  function Erc20ApprovalDocumentBuilder() {}\n  Erc20ApprovalDocumentBuilder.build = function (approval, block, confirmed, chainId) {\n    var chain = Number(chainId);\n    var document = {\n      id: LogRelatedId.create(chain, approval.transactionHash, approval.logIndex),\n      transactionHash: approval.transactionHash,\n      contract: approval.contract,\n      logIndex: approval.logIndex,\n      owner: approval.owner,\n      spender: approval.spender,\n      value: approval.value,\n      tokenDecimals: parseInt(approval.tokenDecimals, 10),\n      tokenName: approval.tokenName,\n      tokenSymbol: approval.tokenSymbol,\n      blockHash: block.hash,\n      blockTimestamp: parseInt(block.timestamp, 10),\n      blockNumber: parseInt(block.number, 10),\n      confirmed: confirmed,\n      chainId: chain,\n      triggers: TriggerItemsBuilder.build(approval.triggers)\n    };\n    return document;\n  };\n  return Erc20ApprovalDocumentBuilder;\n}();\nvar Erc20ApprovalsProcessor = /** @class */function () {\n  function Erc20ApprovalsProcessor(collectionNameBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n    this.processor = new SimpleProcessor(this.collectionNameBuilder, Erc20ApprovalDocumentBuilder.build);\n  }\n  Erc20ApprovalsProcessor.prototype.process = function (batch) {\n    return this.processor.process(batch.erc20Approvals, batch);\n  };\n  return Erc20ApprovalsProcessor;\n}();\nvar TxRelatedId = /** @class */function () {\n  function TxRelatedId() {}\n  TxRelatedId.create = function (chainId, transactionHash) {\n    var safeTransactionHash = transactionHash.toLowerCase();\n    return Sha256.hash(\"\".concat(chainId, \";\").concat(safeTransactionHash));\n  };\n  return TxRelatedId;\n}();\nvar InternalTxDocumentBuilder = /** @class */function () {\n  function InternalTxDocumentBuilder() {}\n  InternalTxDocumentBuilder.build = function (tx, block, confirmed, chainId) {\n    var chain = Number(chainId);\n    return {\n      id: TxRelatedId.create(chain, tx.transactionHash),\n      hash: tx.transactionHash,\n      chainId: chain,\n      from: tx.from,\n      to: tx.to,\n      value: tx.value,\n      gas: parseInt(tx.gas || '0', 10),\n      blockHash: block.hash,\n      blockTimestamp: parseInt(block.timestamp, 10),\n      blockNumber: parseInt(block.number, 10),\n      confirmed: confirmed\n    };\n  };\n  return InternalTxDocumentBuilder;\n}();\nvar InternalTxsProcessor = /** @class */function () {\n  function InternalTxsProcessor(collectionNameBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n    this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, InternalTxDocumentBuilder.build);\n  }\n  InternalTxsProcessor.prototype.process = function (batch) {\n    return this.simpleProcessor.process(batch.txsInternal, batch);\n  };\n  return InternalTxsProcessor;\n}();\nvar LogDocumentValueFormatter = /** @class */function () {\n  function LogDocumentValueFormatter() {}\n  LogDocumentValueFormatter.format = function (param) {\n    switch (param.type) {\n      case 'string':\n        return param.value;\n      case 'address':\n        return param.value.toLowerCase();\n      default:\n        if (BigNumber.isBigNumber(param.value)) {\n          return param.value.toString();\n        }\n        return param.value.toString();\n    }\n  };\n  return LogDocumentValueFormatter;\n}();\nvar ParamNameResolver = /** @class */function () {\n  function ParamNameResolver(restrictedNames) {\n    this.restrictedNames = restrictedNames;\n    this.usedNames = [];\n  }\n  ParamNameResolver.prototype.iterate = function (object, callback) {\n    var _this = this;\n    // We need to always keep parameters in the same order\n    // because the RowParamNameResolver is order-sensitive.\n    var sortedNames = Object.keys(object).sort(function (a, b) {\n      return a.localeCompare(b);\n    });\n    sortedNames.forEach(function (name) {\n      var safeName = _this.resolve(name);\n      callback(safeName, object[name]);\n    });\n  };\n  ParamNameResolver.prototype.resolve = function (name) {\n    if (this.isUsed(name)) {\n      do {\n        name = \"_\".concat(name);\n      } while (this.isUsed(name));\n    }\n    this.usedNames.push(name);\n    return name;\n  };\n  ParamNameResolver.prototype.isUsed = function (name) {\n    return this.restrictedNames.includes(name) || this.usedNames.includes(name);\n  };\n  return ParamNameResolver;\n}();\nvar paramNames = ['id', 'name', 'logIndex', 'transactionHash', 'address', 'blockHash', 'blockTimestamp', 'blockNumber', 'confirmed', 'chainId', 'triggers'];\nvar restrictedParamNames = __spreadArray(__spreadArray([], paramNames, true), [\n// Some extra names\n'_id', 'uniqueId', 'updatedAt', 'createdAt', 'user', 'userId'], false);\nvar LogDocumentBuilder = /** @class */function () {\n  function LogDocumentBuilder() {}\n  LogDocumentBuilder.build = function (log, parsedLog, block, confirmed, chainId) {\n    var nameResolver = new ParamNameResolver(restrictedParamNames);\n    var chain = Number(chainId);\n    var document = {\n      id: LogRelatedId.create(chain, log.transactionHash, log.logIndex),\n      name: parsedLog.name,\n      logIndex: parseInt(log.logIndex, 10),\n      transactionHash: log.transactionHash,\n      address: log.address,\n      blockHash: block.hash,\n      blockTimestamp: parseInt(block.timestamp, 10),\n      blockNumber: parseInt(block.number, 10),\n      confirmed: confirmed,\n      chainId: chain,\n      triggers: TriggerItemsBuilder.build(log.triggers)\n    };\n    nameResolver.iterate(parsedLog.params, function (safeParamName, paramValue) {\n      document[safeParamName] = LogDocumentValueFormatter.format(paramValue);\n    });\n    return document;\n  };\n  return LogDocumentBuilder;\n}();\nvar LogParser = /** @class */function () {\n  function LogParser(abiItems) {\n    this.abiInterface = new Interface(abiItems);\n  }\n  LogParser.prototype.read = function (log) {\n    // Solidity supports max 3 topics. https://docs.soliditylang.org/en/latest/contracts.html#events\n    var topics = [log.topic0, log.topic1, log.topic2, log.topic3].filter(function (t) {\n      return t !== null;\n    });\n    // Do not call the `this.abiInterface.parseLog()` method here! The @ethersproject/abi package (5.7.0) has a bug,\n    // that doesn't return `args` with named keys in a specific case. That problem doesn't occur when we call directly the decodeEventLog() method.\n    var eventFragment = this.abiInterface.getEvent(topics[0]);\n    var args = this.abiInterface.decodeEventLog(eventFragment, log.data, topics);\n    var params = {};\n    eventFragment.inputs.forEach(function (input, index) {\n      var type = input.type,\n        name = input.name;\n      var value = args[index];\n      if (value instanceof Indexed) {\n        value = value.hash;\n      }\n      params[name] = {\n        type: type,\n        value: value\n      };\n    });\n    return {\n      name: eventFragment.name,\n      params: params\n    };\n  };\n  return LogParser;\n}();\nvar LogsProcessor = /** @class */function () {\n  function LogsProcessor(collectionNameBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n  }\n  LogsProcessor.prototype.process = function (batch) {\n    var updates = [];\n    if (batch.abi.length < 1) {\n      return updates;\n    }\n    var logParser = new LogParser(batch.abi);\n    for (var _i = 0, _a = batch.logs; _i < _a.length; _i++) {\n      var log = _a[_i];\n      var logParams = logParser.read(log);\n      var document_1 = LogDocumentBuilder.build(log, logParams, batch.block, batch.confirmed, batch.chainId);\n      updates.push({\n        collectionName: this.collectionNameBuilder.build(batch.tag),\n        document: document_1\n      });\n    }\n    return updates;\n  };\n  return LogsProcessor;\n}();\nvar NftTransferDocumentBuilder = /** @class */function () {\n  function NftTransferDocumentBuilder() {}\n  NftTransferDocumentBuilder.build = function (transfer, block, confirmed, chainId) {\n    var chain = Number(chainId);\n    var document = {\n      id: LogRelatedId.create(chain, transfer.transactionHash, transfer.logIndex),\n      transactionHash: transfer.transactionHash,\n      contract: transfer.contract,\n      logIndex: transfer.logIndex,\n      operator: transfer.operator,\n      from: transfer.from,\n      to: transfer.to,\n      tokenId: transfer.tokenId,\n      amount: transfer.amount,\n      tokenContractType: transfer.tokenContractType,\n      tokenName: transfer.tokenName,\n      tokenSymbol: transfer.tokenSymbol,\n      blockHash: block.hash,\n      blockTimestamp: parseInt(block.timestamp, 10),\n      blockNumber: parseInt(block.number, 10),\n      confirmed: confirmed,\n      chainId: chain,\n      triggers: TriggerItemsBuilder.build(transfer.triggers)\n    };\n    return document;\n  };\n  return NftTransferDocumentBuilder;\n}();\nvar NftTransfersProcessor = /** @class */function () {\n  function NftTransfersProcessor(collectionNameBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n    this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, NftTransferDocumentBuilder.build);\n  }\n  NftTransfersProcessor.prototype.process = function (batch) {\n    return this.simpleProcessor.process(batch.nftTransfers, batch);\n  };\n  return NftTransfersProcessor;\n}();\nvar NftApprovalDocumentBuilder = /** @class */function () {\n  function NftApprovalDocumentBuilder() {}\n  NftApprovalDocumentBuilder.build = function (approval, block, confirmed, chainId) {\n    var chain = Number(chainId);\n    var document = {\n      id: LogRelatedId.create(chain, approval.transactionHash, approval.logIndex),\n      transactionHash: approval.transactionHash,\n      contract: approval.contract,\n      logIndex: approval.logIndex,\n      operator: approval.operator,\n      account: approval.account,\n      approvedAll: approval.approvedAll,\n      tokenId: approval.tokenId,\n      tokenContractType: approval.tokenContractType,\n      tokenName: approval.tokenName,\n      tokenSymbol: approval.tokenSymbol,\n      blockHash: block.hash,\n      blockTimestamp: parseInt(block.timestamp, 10),\n      blockNumber: parseInt(block.number, 10),\n      confirmed: confirmed,\n      chainId: chain\n    };\n    return document;\n  };\n  return NftApprovalDocumentBuilder;\n}();\nvar NftApprovalsProcessor = /** @class */function () {\n  function NftApprovalsProcessor(collectionNameBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n    this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, NftApprovalDocumentBuilder.build);\n  }\n  NftApprovalsProcessor.prototype.process = function (batch) {\n    return this.simpleProcessor.process(batch.nftTokenApprovals, batch);\n  };\n  return NftApprovalsProcessor;\n}();\nvar TxDocumentBuilder = /** @class */function () {\n  function TxDocumentBuilder() {}\n  TxDocumentBuilder.build = function (tx, block, confirmed, chainId) {\n    var chain = Number(chainId);\n    return {\n      id: TxRelatedId.create(chain, tx.hash),\n      hash: tx.hash,\n      chainId: chain,\n      transactionIndex: parseInt(tx.transactionIndex, 10),\n      gas: parseInt(tx.gas, 10),\n      gasPrice: parseInt(tx.gasPrice, 10),\n      nonce: parseInt(tx.nonce, 10),\n      fromAddress: tx.fromAddress,\n      toAddress: tx.toAddress,\n      value: tx.value || '0',\n      input: tx.input,\n      type: parseInt(tx.type, 10),\n      receiptStatus: parseInt(tx.receiptStatus, 10),\n      receiptGasUsed: parseInt(tx.receiptGasUsed, 10),\n      receiptCumulativeGasUsed: parseInt(tx.receiptCumulativeGasUsed, 10),\n      blockHash: block.hash,\n      blockTimestamp: parseInt(block.timestamp, 10),\n      blockNumber: parseInt(block.number, 10),\n      confirmed: confirmed,\n      triggers: TriggerItemsBuilder.build(tx.triggers)\n    };\n  };\n  return TxDocumentBuilder;\n}();\nvar TxsProcessor = /** @class */function () {\n  function TxsProcessor(collectionNameBuilder) {\n    this.collectionNameBuilder = collectionNameBuilder;\n    this.processor = new SimpleProcessor(this.collectionNameBuilder, TxDocumentBuilder.build);\n  }\n  TxsProcessor.prototype.process = function (batch) {\n    return this.processor.process(batch.txs, batch);\n  };\n  return TxsProcessor;\n}();\nvar BatchProcessor = /** @class */function () {\n  function BatchProcessor(erc20ApprovalsProcessor, erc20TransfersProcessor, internalTxsProcessor, logsProcessor, nftApprovalsProcessor, nftTransfersProcessor, txsProcessor) {\n    this.erc20ApprovalsProcessor = erc20ApprovalsProcessor;\n    this.erc20TransfersProcessor = erc20TransfersProcessor;\n    this.internalTxsProcessor = internalTxsProcessor;\n    this.logsProcessor = logsProcessor;\n    this.nftApprovalsProcessor = nftApprovalsProcessor;\n    this.nftTransfersProcessor = nftTransfersProcessor;\n    this.txsProcessor = txsProcessor;\n  }\n  BatchProcessor.create = function () {\n    var nameBuilder = new CollectionNameBuilder();\n    return new BatchProcessor(new Erc20ApprovalsProcessor(nameBuilder), new Erc20TransfersProcessor(nameBuilder), new InternalTxsProcessor(nameBuilder), new LogsProcessor(nameBuilder), new NftApprovalsProcessor(nameBuilder), new NftTransfersProcessor(nameBuilder), new TxsProcessor(nameBuilder));\n  };\n  BatchProcessor.prototype.process = function (batch) {\n    var _this = this;\n    return {\n      erc20Approvals: function () {\n        return _this.erc20ApprovalsProcessor.process(batch);\n      },\n      erc20Transfers: function () {\n        return _this.erc20TransfersProcessor.process(batch);\n      },\n      internalTxs: function () {\n        return _this.internalTxsProcessor.process(batch);\n      },\n      logs: function () {\n        return _this.logsProcessor.process(batch);\n      },\n      nftApprovals: function () {\n        return _this.nftApprovalsProcessor.process(batch);\n      },\n      nftTransfers: function () {\n        return _this.nftTransfersProcessor.process(batch);\n      },\n      txs: function () {\n        return _this.txsProcessor.process(batch);\n      }\n    };\n  };\n  return BatchProcessor;\n}();\nvar parseLog = function (webhookData) {\n  if (!isWebhook(webhookData)) {\n    throw new MoralisStreamError({\n      code: StreamErrorCode.GENERIC_STREAM_ERROR,\n      message: 'Cannot decode the logs. No logs found in the webhook, or invalid webhook provided.'\n    });\n  }\n  if (!hasAbis(webhookData)) {\n    throw new MoralisStreamError({\n      code: StreamErrorCode.GENERIC_STREAM_ERROR,\n      message: 'Cannot decode the logs. No abis found in the provided webhook.'\n    });\n  }\n  var logs = webhookData.logs,\n    abi = webhookData.abi;\n  var decodedLogs = [];\n  logs.forEach(function (currentLog) {\n    var params = new LogParser(abi).read(currentLog).params;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var decodedLog = {};\n    for (var key in params) {\n      if (Object.prototype.hasOwnProperty.call(params, key)) {\n        var element = params[key];\n        decodedLog[key] = element.value;\n      }\n    }\n    decodedLogs.push(decodedLog);\n  });\n  return decodedLogs;\n};\nvar makeGetAptosAddresses = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new PaginatedOperationResolver(getAddressesAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeGetEvmAddresses = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new PaginatedOperationResolver(getAddressesEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeGetAddresses = function (core, baseUrl) {\n  return function (getAddressesOptions) {\n    switch (getAddressesOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeGetAptosAddresses(core, baseUrl, getAddressesOptions);\n      case StreamNetwork.EVM:\n        return makeGetEvmAddresses(core, baseUrl, getAddressesOptions);\n      default:\n        if (getAddressesOptions.networkType === undefined) {\n          return makeGetEvmAddresses(core, baseUrl, getAddressesOptions);\n        }\n        throw new IncorrectNetworkError(getAddressesOptions.networkType);\n    }\n  };\n};\nvar makeDeleteAddressAptosStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(deleteAddressAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeDeleteAddressEvmStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  var options = __rest(_a, [\"networkType\"]);\n  return new OperationResolver(deleteAddressEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeDeleteAddress = function (core, baseUrl) {\n  return function (deleteAddressOptions) {\n    switch (deleteAddressOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeDeleteAddressAptosStream(core, baseUrl, deleteAddressOptions);\n      case StreamNetwork.EVM:\n        return makeDeleteAddressEvmStream(core, baseUrl, deleteAddressOptions);\n      default:\n        if (deleteAddressOptions.networkType === undefined) {\n          return makeDeleteAddressEvmStream(core, baseUrl, deleteAddressOptions);\n        }\n        throw new IncorrectNetworkError(deleteAddressOptions.networkType);\n    }\n  };\n};\nvar makeGetAptosStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  _a.network;\n  var options = __rest(_a, [\"networkType\", \"network\"]);\n  return new OperationResolver(getStreamAptosOperation, baseUrl, core).fetch(options);\n};\nvar makeGetEvmStream = function (core, baseUrl, _a) {\n  _a.networkType;\n  _a.network;\n  var options = __rest(_a, [\"networkType\", \"network\"]);\n  return new OperationResolver(getStreamEvmOperation, baseUrl, core).fetch(options);\n};\nvar makeGetStreamById = function (core, baseUrl) {\n  return function (getStreamOptions) {\n    // Backwards compatibility for the 'network' parameter\n    if (!getStreamOptions.networkType && getStreamOptions.network) {\n      getStreamOptions.networkType = getStreamOptions.network;\n    }\n    switch (getStreamOptions.networkType) {\n      case StreamNetwork.APTOS:\n        return makeGetAptosStream(core, baseUrl, getStreamOptions);\n      case StreamNetwork.EVM:\n        return makeGetEvmStream(core, baseUrl, getStreamOptions);\n      default:\n        if (getStreamOptions.networkType === undefined) {\n          return makeGetEvmStream(core, baseUrl, getStreamOptions);\n        }\n        throw new IncorrectNetworkError(getStreamOptions.networkType);\n    }\n  };\n};\nvar StreamsConfigSetup = /** @class */function () {\n  function StreamsConfigSetup() {}\n  StreamsConfigSetup.register = function (config) {\n    config.registerKey(StreamsConfig.streamsSecret);\n  };\n  return StreamsConfigSetup;\n}();\nvar BASE_URL = 'https://api.moralis-streams.com';\nvar Streams = /** @class */function (_super) {\n  __extends(Streams, _super);\n  function Streams(core) {\n    var _this = _super.call(this, Streams.moduleName, core, function () {\n      return BASE_URL;\n    }) || this;\n    _this.add = makeCreateStream(_this.core, BASE_URL);\n    _this.update = makeUpdateStream(_this.core, BASE_URL);\n    _this.delete = makeDeleteStream(_this.core, BASE_URL);\n    _this.getAll = makeGetStreams(_this.core, BASE_URL);\n    _this.getById = makeGetStreamById(_this.core, BASE_URL);\n    _this.updateStatus = makeUpdateStreamStatus(_this.core, BASE_URL);\n    _this.addAddress = makeAddAddress(_this.core, BASE_URL);\n    _this.getAddresses = makeGetAddresses(_this.core, BASE_URL);\n    _this.deleteAddress = makeDeleteAddress(_this.core, BASE_URL);\n    _this.getHistory = _this.createPaginatedFetcher(getHistoryOperation);\n    _this.getLogs = _this.createPaginatedFetcher(getLogsOperation);\n    _this.retry = _this.createFetcher(replayHistoryOperation);\n    _this._getStats = _this.createFetcher(getStatsOperation);\n    _this.getStats = function () {\n      return _this._getStats({});\n    };\n    _this.getStatsById = _this.createFetcher(getStatsByIdOperation);\n    _this.setSettings = _this.createFetcher(setSettingsOperation);\n    _this._readSettings = _this.createFetcher(getSettingsOperation);\n    _this.readSettings = function () {\n      return _this._readSettings({});\n    };\n    _this.verifySignature = function (options) {\n      return makeVerifySignature(_this.core.config)(options);\n    };\n    _this.parsedLogs = function (webhookData) {\n      return parseLog(webhookData);\n    };\n    return _this;\n  }\n  Streams.create = function (core) {\n    return new Streams(core !== null && core !== void 0 ? core : CoreProvider.getDefault());\n  };\n  Streams.prototype.setup = function () {\n    StreamsConfigSetup.register(this.core.config);\n  };\n  Streams.prototype.start = function () {\n    // Nothing\n  };\n  Streams.prototype.createFetcher = function (operation) {\n    return new OperationResolver(operation, BASE_URL, this.core).fetch;\n  };\n  Streams.prototype.createPaginatedFetcher = function (operation) {\n    return new PaginatedOperationResolver(operation, BASE_URL, this.core).fetch;\n  };\n  Streams.moduleName = 'streams';\n  return Streams;\n}(ApiModule);\nexport { BatchProcessor, CollectionNameBuilder, Erc20ApprovalDocumentBuilder, Erc20ApprovalsProcessor, Erc20TransferDocumentBuilder, Erc20TransfersProcessor, InternalTxDocumentBuilder, InternalTxsProcessor, LogDocumentBuilder, LogDocumentValueFormatter, LogParser, LogsProcessor, NftApprovalDocumentBuilder, NftApprovalsProcessor, NftTransferDocumentBuilder, NftTransfersProcessor, ParamNameResolver, Streams, TxDocumentBuilder, TxsProcessor };","map":{"version":3,"names":["OperationResolver","PaginatedOperationResolver","ApiUtilsConfig","StreamErrorCode","MoralisStreamError","CoreProvider","ApiModule","createStreamAptosOperation","createStreamEvmOperation","updateStreamAptosOperation","updateStreamEvmOperation","deleteStreamAptosOperation","deleteStreamEvmOperation","getStreamsAptosOperation","getStreamsEvmOperation","addAddressAptosOperation","addAddressEvmOperation","updateStreamStatusAptosOperation","updateStreamStatusEvmOperation","getAddressesAptosOperation","getAddressesEvmOperation","deleteAddressAptosOperation","deleteAddressEvmOperation","getStreamAptosOperation","getStreamEvmOperation","getHistoryOperation","getLogsOperation","replayHistoryOperation","getStatsOperation","getStatsByIdOperation","setSettingsOperation","getSettingsOperation","toBuffer","bufferToHex","keccak256","sha256","toUtf8Bytes","BigNumber","Indexed","Interface","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__rest","s","e","t","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","__spreadArray","to","from","pack","arguments","l","ar","slice","concat","StreamNetwork","IncorrectNetworkError","_super","network","code","INCORRECT_NETWORK","message","values","map","value","join","makeCreateAptosStream","core","baseUrl","_a","networkType","options","fetch","makeCreateEvmStream","makeCreateStream","createStreamOptions","APTOS","EVM","undefined","makeUpdateAptosStream","makeUpdateEvmStream","makeUpdateStream","updateStreamOptions","makeDeleteAptosStream","makeDeleteEvmStream","makeDeleteStream","deleteStreamOptions","makeGetAptosStream$1","makeGetEvmStream$1","makeGetStreams","getStreamsOptions","SHA3_NULL_S","isHexStrict","hex","test","sha3","bufferValue","toString","Buffer","returnValue","StreamsConfig","streamsSecret","name","defaultValue","makeVerifySignature","config","body","signature","secret","get","apiKey","GENERIC_STREAM_ERROR","generatedSignature","JSON","stringify","INVALID_SIGNATURE","makeAddAddressAptosStream","makeAddAddressEvmStream","makeAddAddress","addAddressOptions","makeUpdateAptosStreamStatus","makeUpdateEvmStreamStatus","makeUpdateStreamStatus","hasAbis","webhookData","abi","isWebhook","CollectionNameBuilder","cache","cacheLimit","build","tag","result","process","parts","split","filter","substring","toUpperCase","toLowerCase","Error","SimpleProcessor","collectionNameBuilder","documentBuilder","items","batch","updates","_i","items_1","item","document_1","block","confirmed","chainId","push","collectionName","document","Sha256","hash","bytes","LogRelatedId","transactionHash","logIndex","safeTransactionHash","TriggerItemsBuilder","triggers","trigger","convertValue","type","isArray","Erc20TransferDocumentBuilder","transfer","chain","Number","id","contract","tokenDecimals","parseInt","tokenName","tokenSymbol","blockHash","blockTimestamp","timestamp","blockNumber","number","Erc20TransfersProcessor","simpleProcessor","erc20Transfers","Erc20ApprovalDocumentBuilder","approval","owner","spender","Erc20ApprovalsProcessor","processor","erc20Approvals","TxRelatedId","InternalTxDocumentBuilder","tx","gas","InternalTxsProcessor","txsInternal","LogDocumentValueFormatter","format","param","isBigNumber","ParamNameResolver","restrictedNames","usedNames","iterate","object","callback","_this","sortedNames","keys","sort","a","localeCompare","forEach","safeName","resolve","isUsed","includes","paramNames","restrictedParamNames","LogDocumentBuilder","log","parsedLog","nameResolver","address","params","safeParamName","paramValue","LogParser","abiItems","abiInterface","read","topics","topic0","topic1","topic2","topic3","eventFragment","getEvent","args","decodeEventLog","data","inputs","input","index","LogsProcessor","logParser","logs","logParams","NftTransferDocumentBuilder","operator","tokenId","amount","tokenContractType","NftTransfersProcessor","nftTransfers","NftApprovalDocumentBuilder","account","approvedAll","NftApprovalsProcessor","nftTokenApprovals","TxDocumentBuilder","transactionIndex","gasPrice","nonce","fromAddress","toAddress","receiptStatus","receiptGasUsed","receiptCumulativeGasUsed","TxsProcessor","txs","BatchProcessor","erc20ApprovalsProcessor","erc20TransfersProcessor","internalTxsProcessor","logsProcessor","nftApprovalsProcessor","nftTransfersProcessor","txsProcessor","nameBuilder","internalTxs","nftApprovals","parseLog","decodedLogs","currentLog","decodedLog","key","element","makeGetAptosAddresses","makeGetEvmAddresses","makeGetAddresses","getAddressesOptions","makeDeleteAddressAptosStream","makeDeleteAddressEvmStream","makeDeleteAddress","deleteAddressOptions","makeGetAptosStream","makeGetEvmStream","makeGetStreamById","getStreamOptions","StreamsConfigSetup","register","registerKey","BASE_URL","Streams","moduleName","add","update","delete","getAll","getById","updateStatus","addAddress","getAddresses","deleteAddress","getHistory","createPaginatedFetcher","getLogs","retry","createFetcher","_getStats","getStats","getStatsById","setSettings","_readSettings","readSettings","verifySignature","parsedLogs","getDefault","setup","start","operation"],"sources":["C:/Users/user/Desktop/Social-Accenture/Learning-platform/node_modules/@moralisweb3/streams/lib/esm/index.js"],"sourcesContent":["import { OperationResolver, PaginatedOperationResolver, ApiUtilsConfig } from '@moralisweb3/api-utils';\nimport { StreamErrorCode, MoralisStreamError, CoreProvider, ApiModule } from '@moralisweb3/common-core';\nimport { createStreamAptosOperation, createStreamEvmOperation, updateStreamAptosOperation, updateStreamEvmOperation, deleteStreamAptosOperation, deleteStreamEvmOperation, getStreamsAptosOperation, getStreamsEvmOperation, addAddressAptosOperation, addAddressEvmOperation, updateStreamStatusAptosOperation, updateStreamStatusEvmOperation, getAddressesAptosOperation, getAddressesEvmOperation, deleteAddressAptosOperation, deleteAddressEvmOperation, getStreamAptosOperation, getStreamEvmOperation, getHistoryOperation, getLogsOperation, replayHistoryOperation, getStatsOperation, getStatsByIdOperation, setSettingsOperation, getSettingsOperation } from '@moralisweb3/common-streams-utils';\nimport { toBuffer, bufferToHex, keccak256 } from 'ethereumjs-util';\nimport { sha256 } from '@ethersproject/sha2';\nimport { toUtf8Bytes } from '@ethersproject/strings';\nimport { BigNumber } from '@ethersproject/bignumber';\nimport { Indexed, Interface } from '@ethersproject/abi';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nvar StreamNetwork;\r\n(function (StreamNetwork) {\r\n    StreamNetwork[\"APTOS\"] = \"aptos\";\r\n    StreamNetwork[\"EVM\"] = \"evm\";\r\n})(StreamNetwork || (StreamNetwork = {}));\n\nvar IncorrectNetworkError = /** @class */ (function (_super) {\r\n    __extends(IncorrectNetworkError, _super);\r\n    function IncorrectNetworkError(network) {\r\n        return _super.call(this, {\r\n            code: StreamErrorCode.INCORRECT_NETWORK,\r\n            message: \"Incorrect network provided. Got \\\"\".concat(network, \"\\\", Valid values are: \").concat(Object.values(StreamNetwork)\r\n                .map(function (value) { return \"\\\"\".concat(value, \"\\\"\"); })\r\n                .join(', ')),\r\n        }) || this;\r\n    }\r\n    return IncorrectNetworkError;\r\n}(MoralisStreamError));\n\nvar makeCreateAptosStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(createStreamAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeCreateEvmStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(createStreamEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeCreateStream = function (core, baseUrl) {\r\n    return (function (createStreamOptions) {\r\n        switch (createStreamOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeCreateAptosStream(core, baseUrl, createStreamOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeCreateEvmStream(core, baseUrl, createStreamOptions);\r\n            default:\r\n                if (createStreamOptions.networkType === undefined) {\r\n                    return makeCreateEvmStream(core, baseUrl, createStreamOptions);\r\n                }\r\n                throw new IncorrectNetworkError(createStreamOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar makeUpdateAptosStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(updateStreamAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeUpdateEvmStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(updateStreamEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeUpdateStream = function (core, baseUrl) {\r\n    return (function (updateStreamOptions) {\r\n        switch (updateStreamOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeUpdateAptosStream(core, baseUrl, updateStreamOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeUpdateEvmStream(core, baseUrl, updateStreamOptions);\r\n            default:\r\n                if (updateStreamOptions.networkType === undefined) {\r\n                    return makeUpdateEvmStream(core, baseUrl, updateStreamOptions);\r\n                }\r\n                throw new IncorrectNetworkError(updateStreamOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar makeDeleteAptosStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(deleteStreamAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeDeleteEvmStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(deleteStreamEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeDeleteStream = function (core, baseUrl) {\r\n    return (function (deleteStreamOptions) {\r\n        switch (deleteStreamOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeDeleteAptosStream(core, baseUrl, deleteStreamOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeDeleteEvmStream(core, baseUrl, deleteStreamOptions);\r\n            default:\r\n                if (deleteStreamOptions.networkType === undefined) {\r\n                    return makeDeleteEvmStream(core, baseUrl, deleteStreamOptions);\r\n                }\r\n                throw new IncorrectNetworkError(deleteStreamOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar makeGetAptosStream$1 = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new PaginatedOperationResolver(getStreamsAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeGetEvmStream$1 = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new PaginatedOperationResolver(getStreamsEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeGetStreams = function (core, baseUrl) {\r\n    return (function (getStreamsOptions) {\r\n        switch (getStreamsOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeGetAptosStream$1(core, baseUrl, getStreamsOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeGetEvmStream$1(core, baseUrl, getStreamsOptions);\r\n            default:\r\n                if (getStreamsOptions.networkType === undefined) {\r\n                    return makeGetEvmStream$1(core, baseUrl, getStreamsOptions);\r\n                }\r\n                throw new IncorrectNetworkError(getStreamsOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar SHA3_NULL_S = '0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470';\r\nvar isHexStrict = function (hex) {\r\n    return /^(-)?0x[0-9a-f]*$/i.test(hex);\r\n};\r\nvar sha3 = function (value) {\r\n    var bufferValue;\r\n    if (isHexStrict(value) && /^0x/i.test(value.toString())) {\r\n        bufferValue = toBuffer(value);\r\n    }\r\n    else {\r\n        // Assume value is an arbitrary string\r\n        bufferValue = Buffer.from(value, 'utf-8');\r\n    }\r\n    var returnValue = bufferToHex(keccak256(bufferValue));\r\n    if (returnValue === SHA3_NULL_S) {\r\n        return null;\r\n    }\r\n    return returnValue;\r\n};\n\nvar StreamsConfig = {\r\n    streamsSecret: {\r\n        name: 'streamsSecret',\r\n        defaultValue: null,\r\n    },\r\n};\n\nvar makeVerifySignature = function (config) {\r\n    return function (_a) {\r\n        var body = _a.body, signature = _a.signature;\r\n        var secret = config.get(StreamsConfig.streamsSecret);\r\n        if (!secret) {\r\n            secret = config.get(ApiUtilsConfig.apiKey);\r\n        }\r\n        if (!secret) {\r\n            throw new MoralisStreamError({\r\n                code: StreamErrorCode.GENERIC_STREAM_ERROR,\r\n                message: 'Unable to verify signature without an api key or streams secret',\r\n            });\r\n        }\r\n        var generatedSignature = sha3(JSON.stringify(body) + secret);\r\n        if (signature !== generatedSignature) {\r\n            throw new MoralisStreamError({\r\n                code: StreamErrorCode.INVALID_SIGNATURE,\r\n                message: 'Signature is not valid',\r\n            });\r\n        }\r\n        return true;\r\n    };\r\n};\n\nvar makeAddAddressAptosStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(addAddressAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeAddAddressEvmStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(addAddressEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeAddAddress = function (core, baseUrl) {\r\n    return (function (addAddressOptions) {\r\n        switch (addAddressOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeAddAddressAptosStream(core, baseUrl, addAddressOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeAddAddressEvmStream(core, baseUrl, addAddressOptions);\r\n            default:\r\n                if (addAddressOptions.networkType === undefined) {\r\n                    return makeAddAddressEvmStream(core, baseUrl, addAddressOptions);\r\n                }\r\n                throw new IncorrectNetworkError(addAddressOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar makeUpdateAptosStreamStatus = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(updateStreamStatusAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeUpdateEvmStreamStatus = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(updateStreamStatusEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeUpdateStreamStatus = function (core, baseUrl) {\r\n    return (function (updateStreamOptions) {\r\n        switch (updateStreamOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeUpdateAptosStreamStatus(core, baseUrl, updateStreamOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeUpdateEvmStreamStatus(core, baseUrl, updateStreamOptions);\r\n            default:\r\n                if (updateStreamOptions.networkType === undefined) {\r\n                    return makeUpdateEvmStreamStatus(core, baseUrl, updateStreamOptions);\r\n                }\r\n                throw new IncorrectNetworkError(updateStreamOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar hasAbis = function (webhookData) {\r\n    if (!webhookData.abi || webhookData.abi.length < 1) {\r\n        return false;\r\n    }\r\n    return true;\r\n};\r\nvar isWebhook = function (webhookData) {\r\n    if (typeof webhookData !== 'object' || webhookData === null || !('logs' in webhookData)) {\r\n        return false;\r\n    }\r\n    return true;\r\n};\n\nvar CollectionNameBuilder = /** @class */ (function () {\r\n    function CollectionNameBuilder() {\r\n        this.cache = {};\r\n        this.cacheLimit = 256;\r\n    }\r\n    CollectionNameBuilder.prototype.build = function (tag) {\r\n        var result = this.cache[tag];\r\n        if (!result) {\r\n            result = this.process(tag);\r\n            if (this.cacheLimit > 0) {\r\n                // Simple anti DDOS protection.\r\n                this.cache[tag] = result;\r\n                this.cacheLimit--;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    CollectionNameBuilder.prototype.process = function (tag) {\r\n        var parts = tag\r\n            .split(/[^a-zA-Z0-9_]/)\r\n            .filter(function (p) { return !!p; })\r\n            .map(function (p) {\r\n            return p.substring(0, 1).toUpperCase() + p.substring(1).toLowerCase();\r\n        });\r\n        if (parts.length < 1) {\r\n            throw new Error(\"Cannot build table name from value \\\"\".concat(tag, \"\\\"\"));\r\n        }\r\n        return parts.join('');\r\n    };\r\n    return CollectionNameBuilder;\r\n}());\n\nvar SimpleProcessor = /** @class */ (function () {\r\n    function SimpleProcessor(collectionNameBuilder, documentBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n        this.documentBuilder = documentBuilder;\r\n    }\r\n    SimpleProcessor.prototype.process = function (items, batch) {\r\n        var updates = [];\r\n        if (items) {\r\n            for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n                var item = items_1[_i];\r\n                var document_1 = this.documentBuilder(item, batch.block, batch.confirmed, batch.chainId);\r\n                updates.push({\r\n                    collectionName: this.collectionNameBuilder.build(batch.tag),\r\n                    document: document_1,\r\n                });\r\n            }\r\n        }\r\n        return updates;\r\n    };\r\n    return SimpleProcessor;\r\n}());\n\nvar Sha256 = /** @class */ (function () {\r\n    function Sha256() {\r\n    }\r\n    Sha256.hash = function (value) {\r\n        var bytes = toUtf8Bytes(value);\r\n        return sha256(bytes);\r\n    };\r\n    return Sha256;\r\n}());\n\nvar LogRelatedId = /** @class */ (function () {\r\n    function LogRelatedId() {\r\n    }\r\n    LogRelatedId.create = function (chainId, transactionHash, logIndex) {\r\n        var safeTransactionHash = transactionHash.toLowerCase();\r\n        return Sha256.hash(\"\".concat(chainId, \";\").concat(safeTransactionHash, \";\").concat(logIndex));\r\n    };\r\n    return LogRelatedId;\r\n}());\n\nvar TriggerItemsBuilder = /** @class */ (function () {\r\n    function TriggerItemsBuilder() {\r\n    }\r\n    TriggerItemsBuilder.build = function (triggers) {\r\n        if (!triggers || triggers.length === 0) {\r\n            return undefined;\r\n        }\r\n        return triggers.map(function (trigger) { return ({\r\n            name: String(trigger.name),\r\n            value: convertValue(trigger.value),\r\n        }); });\r\n    };\r\n    return TriggerItemsBuilder;\r\n}());\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nfunction convertValue(value) {\r\n    var type = typeof value;\r\n    if (type === 'string' || type === 'number' || type === 'boolean') {\r\n        return value;\r\n    }\r\n    if (Array.isArray(value)) {\r\n        return value.map(convertValue);\r\n    }\r\n    return String(value);\r\n}\n\nvar Erc20TransferDocumentBuilder = /** @class */ (function () {\r\n    function Erc20TransferDocumentBuilder() {\r\n    }\r\n    Erc20TransferDocumentBuilder.build = function (transfer, block, confirmed, chainId) {\r\n        var chain = Number(chainId);\r\n        var document = {\r\n            id: LogRelatedId.create(chain, transfer.transactionHash, transfer.logIndex),\r\n            transactionHash: transfer.transactionHash,\r\n            contract: transfer.contract,\r\n            logIndex: transfer.logIndex,\r\n            from: transfer.from,\r\n            to: transfer.to,\r\n            value: transfer.value,\r\n            tokenDecimals: parseInt(transfer.tokenDecimals, 10),\r\n            tokenName: transfer.tokenName,\r\n            tokenSymbol: transfer.tokenSymbol,\r\n            blockHash: block.hash,\r\n            blockTimestamp: parseInt(block.timestamp, 10),\r\n            blockNumber: parseInt(block.number, 10),\r\n            confirmed: confirmed,\r\n            chainId: chain,\r\n            triggers: TriggerItemsBuilder.build(transfer.triggers),\r\n        };\r\n        return document;\r\n    };\r\n    return Erc20TransferDocumentBuilder;\r\n}());\n\nvar Erc20TransfersProcessor = /** @class */ (function () {\r\n    function Erc20TransfersProcessor(collectionNameBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n        this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, Erc20TransferDocumentBuilder.build);\r\n    }\r\n    Erc20TransfersProcessor.prototype.process = function (batch) {\r\n        return this.simpleProcessor.process(batch.erc20Transfers, batch);\r\n    };\r\n    return Erc20TransfersProcessor;\r\n}());\n\nvar Erc20ApprovalDocumentBuilder = /** @class */ (function () {\r\n    function Erc20ApprovalDocumentBuilder() {\r\n    }\r\n    Erc20ApprovalDocumentBuilder.build = function (approval, block, confirmed, chainId) {\r\n        var chain = Number(chainId);\r\n        var document = {\r\n            id: LogRelatedId.create(chain, approval.transactionHash, approval.logIndex),\r\n            transactionHash: approval.transactionHash,\r\n            contract: approval.contract,\r\n            logIndex: approval.logIndex,\r\n            owner: approval.owner,\r\n            spender: approval.spender,\r\n            value: approval.value,\r\n            tokenDecimals: parseInt(approval.tokenDecimals, 10),\r\n            tokenName: approval.tokenName,\r\n            tokenSymbol: approval.tokenSymbol,\r\n            blockHash: block.hash,\r\n            blockTimestamp: parseInt(block.timestamp, 10),\r\n            blockNumber: parseInt(block.number, 10),\r\n            confirmed: confirmed,\r\n            chainId: chain,\r\n            triggers: TriggerItemsBuilder.build(approval.triggers),\r\n        };\r\n        return document;\r\n    };\r\n    return Erc20ApprovalDocumentBuilder;\r\n}());\n\nvar Erc20ApprovalsProcessor = /** @class */ (function () {\r\n    function Erc20ApprovalsProcessor(collectionNameBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n        this.processor = new SimpleProcessor(this.collectionNameBuilder, Erc20ApprovalDocumentBuilder.build);\r\n    }\r\n    Erc20ApprovalsProcessor.prototype.process = function (batch) {\r\n        return this.processor.process(batch.erc20Approvals, batch);\r\n    };\r\n    return Erc20ApprovalsProcessor;\r\n}());\n\nvar TxRelatedId = /** @class */ (function () {\r\n    function TxRelatedId() {\r\n    }\r\n    TxRelatedId.create = function (chainId, transactionHash) {\r\n        var safeTransactionHash = transactionHash.toLowerCase();\r\n        return Sha256.hash(\"\".concat(chainId, \";\").concat(safeTransactionHash));\r\n    };\r\n    return TxRelatedId;\r\n}());\n\nvar InternalTxDocumentBuilder = /** @class */ (function () {\r\n    function InternalTxDocumentBuilder() {\r\n    }\r\n    InternalTxDocumentBuilder.build = function (tx, block, confirmed, chainId) {\r\n        var chain = Number(chainId);\r\n        return {\r\n            id: TxRelatedId.create(chain, tx.transactionHash),\r\n            hash: tx.transactionHash,\r\n            chainId: chain,\r\n            from: tx.from,\r\n            to: tx.to,\r\n            value: tx.value,\r\n            gas: parseInt(tx.gas || '0', 10),\r\n            blockHash: block.hash,\r\n            blockTimestamp: parseInt(block.timestamp, 10),\r\n            blockNumber: parseInt(block.number, 10),\r\n            confirmed: confirmed,\r\n        };\r\n    };\r\n    return InternalTxDocumentBuilder;\r\n}());\n\nvar InternalTxsProcessor = /** @class */ (function () {\r\n    function InternalTxsProcessor(collectionNameBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n        this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, InternalTxDocumentBuilder.build);\r\n    }\r\n    InternalTxsProcessor.prototype.process = function (batch) {\r\n        return this.simpleProcessor.process(batch.txsInternal, batch);\r\n    };\r\n    return InternalTxsProcessor;\r\n}());\n\nvar LogDocumentValueFormatter = /** @class */ (function () {\r\n    function LogDocumentValueFormatter() {\r\n    }\r\n    LogDocumentValueFormatter.format = function (param) {\r\n        switch (param.type) {\r\n            case 'string':\r\n                return param.value;\r\n            case 'address':\r\n                return param.value.toLowerCase();\r\n            default:\r\n                if (BigNumber.isBigNumber(param.value)) {\r\n                    return param.value.toString();\r\n                }\r\n                return param.value.toString();\r\n        }\r\n    };\r\n    return LogDocumentValueFormatter;\r\n}());\n\nvar ParamNameResolver = /** @class */ (function () {\r\n    function ParamNameResolver(restrictedNames) {\r\n        this.restrictedNames = restrictedNames;\r\n        this.usedNames = [];\r\n    }\r\n    ParamNameResolver.prototype.iterate = function (object, callback) {\r\n        var _this = this;\r\n        // We need to always keep parameters in the same order\r\n        // because the RowParamNameResolver is order-sensitive.\r\n        var sortedNames = Object.keys(object).sort(function (a, b) { return a.localeCompare(b); });\r\n        sortedNames.forEach(function (name) {\r\n            var safeName = _this.resolve(name);\r\n            callback(safeName, object[name]);\r\n        });\r\n    };\r\n    ParamNameResolver.prototype.resolve = function (name) {\r\n        if (this.isUsed(name)) {\r\n            do {\r\n                name = \"_\".concat(name);\r\n            } while (this.isUsed(name));\r\n        }\r\n        this.usedNames.push(name);\r\n        return name;\r\n    };\r\n    ParamNameResolver.prototype.isUsed = function (name) {\r\n        return this.restrictedNames.includes(name) || this.usedNames.includes(name);\r\n    };\r\n    return ParamNameResolver;\r\n}());\n\nvar paramNames = [\r\n    'id',\r\n    'name',\r\n    'logIndex',\r\n    'transactionHash',\r\n    'address',\r\n    'blockHash',\r\n    'blockTimestamp',\r\n    'blockNumber',\r\n    'confirmed',\r\n    'chainId',\r\n    'triggers',\r\n];\r\nvar restrictedParamNames = __spreadArray(__spreadArray([], paramNames, true), [\r\n    // Some extra names\r\n    '_id',\r\n    'uniqueId',\r\n    'updatedAt',\r\n    'createdAt',\r\n    'user',\r\n    'userId',\r\n], false);\r\nvar LogDocumentBuilder = /** @class */ (function () {\r\n    function LogDocumentBuilder() {\r\n    }\r\n    LogDocumentBuilder.build = function (log, parsedLog, block, confirmed, chainId) {\r\n        var nameResolver = new ParamNameResolver(restrictedParamNames);\r\n        var chain = Number(chainId);\r\n        var document = {\r\n            id: LogRelatedId.create(chain, log.transactionHash, log.logIndex),\r\n            name: parsedLog.name,\r\n            logIndex: parseInt(log.logIndex, 10),\r\n            transactionHash: log.transactionHash,\r\n            address: log.address,\r\n            blockHash: block.hash,\r\n            blockTimestamp: parseInt(block.timestamp, 10),\r\n            blockNumber: parseInt(block.number, 10),\r\n            confirmed: confirmed,\r\n            chainId: chain,\r\n            triggers: TriggerItemsBuilder.build(log.triggers),\r\n        };\r\n        nameResolver.iterate(parsedLog.params, function (safeParamName, paramValue) {\r\n            document[safeParamName] = LogDocumentValueFormatter.format(paramValue);\r\n        });\r\n        return document;\r\n    };\r\n    return LogDocumentBuilder;\r\n}());\n\nvar LogParser = /** @class */ (function () {\r\n    function LogParser(abiItems) {\r\n        this.abiInterface = new Interface(abiItems);\r\n    }\r\n    LogParser.prototype.read = function (log) {\r\n        // Solidity supports max 3 topics. https://docs.soliditylang.org/en/latest/contracts.html#events\r\n        var topics = [log.topic0, log.topic1, log.topic2, log.topic3].filter(function (t) { return t !== null; });\r\n        // Do not call the `this.abiInterface.parseLog()` method here! The @ethersproject/abi package (5.7.0) has a bug,\r\n        // that doesn't return `args` with named keys in a specific case. That problem doesn't occur when we call directly the decodeEventLog() method.\r\n        var eventFragment = this.abiInterface.getEvent(topics[0]);\r\n        var args = this.abiInterface.decodeEventLog(eventFragment, log.data, topics);\r\n        var params = {};\r\n        eventFragment.inputs.forEach(function (input, index) {\r\n            var type = input.type, name = input.name;\r\n            var value = args[index];\r\n            if (value instanceof Indexed) {\r\n                value = value.hash;\r\n            }\r\n            params[name] = {\r\n                type: type,\r\n                value: value,\r\n            };\r\n        });\r\n        return {\r\n            name: eventFragment.name,\r\n            params: params,\r\n        };\r\n    };\r\n    return LogParser;\r\n}());\n\nvar LogsProcessor = /** @class */ (function () {\r\n    function LogsProcessor(collectionNameBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n    }\r\n    LogsProcessor.prototype.process = function (batch) {\r\n        var updates = [];\r\n        if (batch.abi.length < 1) {\r\n            return updates;\r\n        }\r\n        var logParser = new LogParser(batch.abi);\r\n        for (var _i = 0, _a = batch.logs; _i < _a.length; _i++) {\r\n            var log = _a[_i];\r\n            var logParams = logParser.read(log);\r\n            var document_1 = LogDocumentBuilder.build(log, logParams, batch.block, batch.confirmed, batch.chainId);\r\n            updates.push({\r\n                collectionName: this.collectionNameBuilder.build(batch.tag),\r\n                document: document_1,\r\n            });\r\n        }\r\n        return updates;\r\n    };\r\n    return LogsProcessor;\r\n}());\n\nvar NftTransferDocumentBuilder = /** @class */ (function () {\r\n    function NftTransferDocumentBuilder() {\r\n    }\r\n    NftTransferDocumentBuilder.build = function (transfer, block, confirmed, chainId) {\r\n        var chain = Number(chainId);\r\n        var document = {\r\n            id: LogRelatedId.create(chain, transfer.transactionHash, transfer.logIndex),\r\n            transactionHash: transfer.transactionHash,\r\n            contract: transfer.contract,\r\n            logIndex: transfer.logIndex,\r\n            operator: transfer.operator,\r\n            from: transfer.from,\r\n            to: transfer.to,\r\n            tokenId: transfer.tokenId,\r\n            amount: transfer.amount,\r\n            tokenContractType: transfer.tokenContractType,\r\n            tokenName: transfer.tokenName,\r\n            tokenSymbol: transfer.tokenSymbol,\r\n            blockHash: block.hash,\r\n            blockTimestamp: parseInt(block.timestamp, 10),\r\n            blockNumber: parseInt(block.number, 10),\r\n            confirmed: confirmed,\r\n            chainId: chain,\r\n            triggers: TriggerItemsBuilder.build(transfer.triggers),\r\n        };\r\n        return document;\r\n    };\r\n    return NftTransferDocumentBuilder;\r\n}());\n\nvar NftTransfersProcessor = /** @class */ (function () {\r\n    function NftTransfersProcessor(collectionNameBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n        this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, NftTransferDocumentBuilder.build);\r\n    }\r\n    NftTransfersProcessor.prototype.process = function (batch) {\r\n        return this.simpleProcessor.process(batch.nftTransfers, batch);\r\n    };\r\n    return NftTransfersProcessor;\r\n}());\n\nvar NftApprovalDocumentBuilder = /** @class */ (function () {\r\n    function NftApprovalDocumentBuilder() {\r\n    }\r\n    NftApprovalDocumentBuilder.build = function (approval, block, confirmed, chainId) {\r\n        var chain = Number(chainId);\r\n        var document = {\r\n            id: LogRelatedId.create(chain, approval.transactionHash, approval.logIndex),\r\n            transactionHash: approval.transactionHash,\r\n            contract: approval.contract,\r\n            logIndex: approval.logIndex,\r\n            operator: approval.operator,\r\n            account: approval.account,\r\n            approvedAll: approval.approvedAll,\r\n            tokenId: approval.tokenId,\r\n            tokenContractType: approval.tokenContractType,\r\n            tokenName: approval.tokenName,\r\n            tokenSymbol: approval.tokenSymbol,\r\n            blockHash: block.hash,\r\n            blockTimestamp: parseInt(block.timestamp, 10),\r\n            blockNumber: parseInt(block.number, 10),\r\n            confirmed: confirmed,\r\n            chainId: chain,\r\n        };\r\n        return document;\r\n    };\r\n    return NftApprovalDocumentBuilder;\r\n}());\n\nvar NftApprovalsProcessor = /** @class */ (function () {\r\n    function NftApprovalsProcessor(collectionNameBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n        this.simpleProcessor = new SimpleProcessor(this.collectionNameBuilder, NftApprovalDocumentBuilder.build);\r\n    }\r\n    NftApprovalsProcessor.prototype.process = function (batch) {\r\n        return this.simpleProcessor.process(batch.nftTokenApprovals, batch);\r\n    };\r\n    return NftApprovalsProcessor;\r\n}());\n\nvar TxDocumentBuilder = /** @class */ (function () {\r\n    function TxDocumentBuilder() {\r\n    }\r\n    TxDocumentBuilder.build = function (tx, block, confirmed, chainId) {\r\n        var chain = Number(chainId);\r\n        return {\r\n            id: TxRelatedId.create(chain, tx.hash),\r\n            hash: tx.hash,\r\n            chainId: chain,\r\n            transactionIndex: parseInt(tx.transactionIndex, 10),\r\n            gas: parseInt(tx.gas, 10),\r\n            gasPrice: parseInt(tx.gasPrice, 10),\r\n            nonce: parseInt(tx.nonce, 10),\r\n            fromAddress: tx.fromAddress,\r\n            toAddress: tx.toAddress,\r\n            value: tx.value || '0',\r\n            input: tx.input,\r\n            type: parseInt(tx.type, 10),\r\n            receiptStatus: parseInt(tx.receiptStatus, 10),\r\n            receiptGasUsed: parseInt(tx.receiptGasUsed, 10),\r\n            receiptCumulativeGasUsed: parseInt(tx.receiptCumulativeGasUsed, 10),\r\n            blockHash: block.hash,\r\n            blockTimestamp: parseInt(block.timestamp, 10),\r\n            blockNumber: parseInt(block.number, 10),\r\n            confirmed: confirmed,\r\n            triggers: TriggerItemsBuilder.build(tx.triggers),\r\n        };\r\n    };\r\n    return TxDocumentBuilder;\r\n}());\n\nvar TxsProcessor = /** @class */ (function () {\r\n    function TxsProcessor(collectionNameBuilder) {\r\n        this.collectionNameBuilder = collectionNameBuilder;\r\n        this.processor = new SimpleProcessor(this.collectionNameBuilder, TxDocumentBuilder.build);\r\n    }\r\n    TxsProcessor.prototype.process = function (batch) {\r\n        return this.processor.process(batch.txs, batch);\r\n    };\r\n    return TxsProcessor;\r\n}());\n\nvar BatchProcessor = /** @class */ (function () {\r\n    function BatchProcessor(erc20ApprovalsProcessor, erc20TransfersProcessor, internalTxsProcessor, logsProcessor, nftApprovalsProcessor, nftTransfersProcessor, txsProcessor) {\r\n        this.erc20ApprovalsProcessor = erc20ApprovalsProcessor;\r\n        this.erc20TransfersProcessor = erc20TransfersProcessor;\r\n        this.internalTxsProcessor = internalTxsProcessor;\r\n        this.logsProcessor = logsProcessor;\r\n        this.nftApprovalsProcessor = nftApprovalsProcessor;\r\n        this.nftTransfersProcessor = nftTransfersProcessor;\r\n        this.txsProcessor = txsProcessor;\r\n    }\r\n    BatchProcessor.create = function () {\r\n        var nameBuilder = new CollectionNameBuilder();\r\n        return new BatchProcessor(new Erc20ApprovalsProcessor(nameBuilder), new Erc20TransfersProcessor(nameBuilder), new InternalTxsProcessor(nameBuilder), new LogsProcessor(nameBuilder), new NftApprovalsProcessor(nameBuilder), new NftTransfersProcessor(nameBuilder), new TxsProcessor(nameBuilder));\r\n    };\r\n    BatchProcessor.prototype.process = function (batch) {\r\n        var _this = this;\r\n        return {\r\n            erc20Approvals: function () { return _this.erc20ApprovalsProcessor.process(batch); },\r\n            erc20Transfers: function () { return _this.erc20TransfersProcessor.process(batch); },\r\n            internalTxs: function () { return _this.internalTxsProcessor.process(batch); },\r\n            logs: function () { return _this.logsProcessor.process(batch); },\r\n            nftApprovals: function () { return _this.nftApprovalsProcessor.process(batch); },\r\n            nftTransfers: function () { return _this.nftTransfersProcessor.process(batch); },\r\n            txs: function () { return _this.txsProcessor.process(batch); },\r\n        };\r\n    };\r\n    return BatchProcessor;\r\n}());\n\nvar parseLog = function (webhookData) {\r\n    if (!isWebhook(webhookData)) {\r\n        throw new MoralisStreamError({\r\n            code: StreamErrorCode.GENERIC_STREAM_ERROR,\r\n            message: 'Cannot decode the logs. No logs found in the webhook, or invalid webhook provided.',\r\n        });\r\n    }\r\n    if (!hasAbis(webhookData)) {\r\n        throw new MoralisStreamError({\r\n            code: StreamErrorCode.GENERIC_STREAM_ERROR,\r\n            message: 'Cannot decode the logs. No abis found in the provided webhook.',\r\n        });\r\n    }\r\n    var logs = webhookData.logs, abi = webhookData.abi;\r\n    var decodedLogs = [];\r\n    logs.forEach(function (currentLog) {\r\n        var params = new LogParser(abi).read(currentLog).params;\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        var decodedLog = {};\r\n        for (var key in params) {\r\n            if (Object.prototype.hasOwnProperty.call(params, key)) {\r\n                var element = params[key];\r\n                decodedLog[key] = element.value;\r\n            }\r\n        }\r\n        decodedLogs.push(decodedLog);\r\n    });\r\n    return decodedLogs;\r\n};\n\nvar makeGetAptosAddresses = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new PaginatedOperationResolver(getAddressesAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeGetEvmAddresses = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new PaginatedOperationResolver(getAddressesEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeGetAddresses = function (core, baseUrl) {\r\n    return (function (getAddressesOptions) {\r\n        switch (getAddressesOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeGetAptosAddresses(core, baseUrl, getAddressesOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeGetEvmAddresses(core, baseUrl, getAddressesOptions);\r\n            default:\r\n                if (getAddressesOptions.networkType === undefined) {\r\n                    return makeGetEvmAddresses(core, baseUrl, getAddressesOptions);\r\n                }\r\n                throw new IncorrectNetworkError(getAddressesOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar makeDeleteAddressAptosStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(deleteAddressAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeDeleteAddressEvmStream = function (core, baseUrl, _a) {\r\n    _a.networkType; var options = __rest(_a, [\"networkType\"]);\r\n    return new OperationResolver(deleteAddressEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeDeleteAddress = function (core, baseUrl) {\r\n    return (function (deleteAddressOptions) {\r\n        switch (deleteAddressOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeDeleteAddressAptosStream(core, baseUrl, deleteAddressOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeDeleteAddressEvmStream(core, baseUrl, deleteAddressOptions);\r\n            default:\r\n                if (deleteAddressOptions.networkType === undefined) {\r\n                    return makeDeleteAddressEvmStream(core, baseUrl, deleteAddressOptions);\r\n                }\r\n                throw new IncorrectNetworkError(deleteAddressOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar makeGetAptosStream = function (core, baseUrl, _a) {\r\n    _a.networkType; _a.network; var options = __rest(_a, [\"networkType\", \"network\"]);\r\n    return new OperationResolver(getStreamAptosOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeGetEvmStream = function (core, baseUrl, _a) {\r\n    _a.networkType; _a.network; var options = __rest(_a, [\"networkType\", \"network\"]);\r\n    return new OperationResolver(getStreamEvmOperation, baseUrl, core).fetch(options);\r\n};\r\nvar makeGetStreamById = function (core, baseUrl) {\r\n    return (function (getStreamOptions) {\r\n        // Backwards compatibility for the 'network' parameter\r\n        if (!getStreamOptions.networkType && getStreamOptions.network) {\r\n            getStreamOptions.networkType = getStreamOptions.network;\r\n        }\r\n        switch (getStreamOptions.networkType) {\r\n            case StreamNetwork.APTOS:\r\n                return makeGetAptosStream(core, baseUrl, getStreamOptions);\r\n            case StreamNetwork.EVM:\r\n                return makeGetEvmStream(core, baseUrl, getStreamOptions);\r\n            default:\r\n                if (getStreamOptions.networkType === undefined) {\r\n                    return makeGetEvmStream(core, baseUrl, getStreamOptions);\r\n                }\r\n                throw new IncorrectNetworkError(getStreamOptions.networkType);\r\n        }\r\n    });\r\n};\n\nvar StreamsConfigSetup = /** @class */ (function () {\r\n    function StreamsConfigSetup() {\r\n    }\r\n    StreamsConfigSetup.register = function (config) {\r\n        config.registerKey(StreamsConfig.streamsSecret);\r\n    };\r\n    return StreamsConfigSetup;\r\n}());\n\nvar BASE_URL = 'https://api.moralis-streams.com';\r\nvar Streams = /** @class */ (function (_super) {\r\n    __extends(Streams, _super);\r\n    function Streams(core) {\r\n        var _this = _super.call(this, Streams.moduleName, core, function () { return BASE_URL; }) || this;\r\n        _this.add = makeCreateStream(_this.core, BASE_URL);\r\n        _this.update = makeUpdateStream(_this.core, BASE_URL);\r\n        _this.delete = makeDeleteStream(_this.core, BASE_URL);\r\n        _this.getAll = makeGetStreams(_this.core, BASE_URL);\r\n        _this.getById = makeGetStreamById(_this.core, BASE_URL);\r\n        _this.updateStatus = makeUpdateStreamStatus(_this.core, BASE_URL);\r\n        _this.addAddress = makeAddAddress(_this.core, BASE_URL);\r\n        _this.getAddresses = makeGetAddresses(_this.core, BASE_URL);\r\n        _this.deleteAddress = makeDeleteAddress(_this.core, BASE_URL);\r\n        _this.getHistory = _this.createPaginatedFetcher(getHistoryOperation);\r\n        _this.getLogs = _this.createPaginatedFetcher(getLogsOperation);\r\n        _this.retry = _this.createFetcher(replayHistoryOperation);\r\n        _this._getStats = _this.createFetcher(getStatsOperation);\r\n        _this.getStats = function () { return _this._getStats({}); };\r\n        _this.getStatsById = _this.createFetcher(getStatsByIdOperation);\r\n        _this.setSettings = _this.createFetcher(setSettingsOperation);\r\n        _this._readSettings = _this.createFetcher(getSettingsOperation);\r\n        _this.readSettings = function () { return _this._readSettings({}); };\r\n        _this.verifySignature = function (options) { return makeVerifySignature(_this.core.config)(options); };\r\n        _this.parsedLogs = function (webhookData) { return parseLog(webhookData); };\r\n        return _this;\r\n    }\r\n    Streams.create = function (core) {\r\n        return new Streams(core !== null && core !== void 0 ? core : CoreProvider.getDefault());\r\n    };\r\n    Streams.prototype.setup = function () {\r\n        StreamsConfigSetup.register(this.core.config);\r\n    };\r\n    Streams.prototype.start = function () {\r\n        // Nothing\r\n    };\r\n    Streams.prototype.createFetcher = function (operation) {\r\n        return new OperationResolver(operation, BASE_URL, this.core).fetch;\r\n    };\r\n    Streams.prototype.createPaginatedFetcher = function (operation) {\r\n        return new PaginatedOperationResolver(operation, BASE_URL, this.core).fetch;\r\n    };\r\n    Streams.moduleName = 'streams';\r\n    return Streams;\r\n}(ApiModule));\n\nexport { BatchProcessor, CollectionNameBuilder, Erc20ApprovalDocumentBuilder, Erc20ApprovalsProcessor, Erc20TransferDocumentBuilder, Erc20TransfersProcessor, InternalTxDocumentBuilder, InternalTxsProcessor, LogDocumentBuilder, LogDocumentValueFormatter, LogParser, LogsProcessor, NftApprovalDocumentBuilder, NftApprovalsProcessor, NftTransferDocumentBuilder, NftTransfersProcessor, ParamNameResolver, Streams, TxDocumentBuilder, TxsProcessor };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}